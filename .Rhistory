legend.box.background = element_rect(colour = NA, fill = NA),
legend.key = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.margin=unit(0, "cm"),
panel.border = element_rect(colour = "black", fill = NA),
axis.text.x = element_text(size = 14, angle = 0, hjust = 0.5),
axis.text.y = element_text(size = 14, angle = 0, hjust = 0),
axis.title.y = element_text(size = 14, face = "bold", vjust = 4),
axis.title.y.right = element_text(size = 14, face = "bold", vjust = 4),
axis.title.x = element_text(size = 14, face = "bold", vjust = -1),
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
aspect.ratio = 0.4)
p1
p2 <- ggplot() +
#geom_segment(data = periods, mapping=aes(x = min_ma, xend = min_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
#geom_segment(data = periods, mapping=aes(x = max_ma, xend = max_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
geom_segment(data = periods, mapping=aes(x = 0, xend = 541, y = data$modern_temp_mean[1], yend = data$modern_temp_mean[1]), linetype = 1, size = 1, color = "royalblue1") +
geom_rect(data = throwing_shade, mapping=aes(xmin=min_ma, xmax=max_ma, ymin = -6, ymax= Inf), linetype = 0, color="grey90", alpha=0.1)  +
#geom_rect(data = periods, mapping=aes(xmin=300, xmax=0, ymin= -6, ymax= 0), linetype = 1, colour = "black", fill="black", alpha=1)  +
geom_rect(data = periods, mapping=aes(xmin = min_ma, xmax = max_ma, ymin = -6, ymax = -2), linetype = 1, colour = "black", fill=periods$color, alpha=1)  +
geom_text(data = periods, mapping=aes(x = mid_ma, y = -4, label = abbrev), colour = "black", alpha=1)  +
geom_point(data = data, mapping=aes(x = age, y = temperature), colour = "darkgrey", size = 1.1, alpha  = 1) +
geom_point(data = stage_vals, mapping=aes(x = mid_ma, y = temperature), colour = "black", size = 1.1, alpha  = 1) +
#geom_smooth(data = data, mapping=aes(x = age, y = temperature), method = "loess", colour = "red", size = 1.1, alpha  = 0.75) +
scale_x_reverse(expand=c(0,0), limits = c(541, 0)) +
scale_y_continuous(expand=c(0,0), limits = c(-6, 65)) +
labs(x = "", y = expression(bold(paste("Temperature (",degree, C,")")))) +
theme(panel.background = element_blank(),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm"),
#panel.grid.minor.y = element_line(colour = "grey90"),
#panel.grid.minor.x = element_line(colour = "grey90"),
#panel.grid.major.y = element_line(colour = "grey90"),
#panel.grid.major.x = element_line(colour = "grey90"),
legend.position = c(0.2, 0.9),
legend.background = element_blank(),
legend.box.background = element_rect(colour = NA, fill = NA),
legend.key = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.margin=unit(0, "cm"),
panel.border = element_rect(colour = "black", fill = NA),
axis.text.x = element_text(size = 14, angle = 0, hjust = 0.5),
axis.text.y = element_text(size = 14, angle = 0, hjust = 0),
axis.title.y = element_text(size = 14, face = "bold", vjust = 4),
axis.title.y.right = element_text(size = 14, face = "bold", vjust = 4),
axis.title.x = element_text(size = 14, face = "bold", vjust = -1),
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
aspect.ratio = 0.4)
p2
plots <- ggarrange(p2, p1, ncol=1, nrow=2, widths = c(1,1), labels = "AUTO", align = "v")
plots
ggsave(file = "./figures/extracted_temperature.png", plot = plots, width = 150, height = 150, units = "mm", dpi = 600, scale = 1.7)
p1 <- ggplot() +
#geom_segment(data = periods, mapping=aes(x = min_ma, xend = min_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
#geom_segment(data = periods, mapping=aes(x = max_ma, xend = max_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
geom_segment(data = periods, mapping=aes(x = 0, xend = 541, y = data$modern_temp_mean[1], yend = data$modern_temp_mean[1]), linetype = 1, size = 1, color = "royalblue1") +
geom_rect(data = throwing_shade, mapping=aes(xmin=min_ma, xmax=max_ma, ymin = -6, ymax= Inf), linetype = 0, color="grey90", alpha=0.1)  +
#geom_rect(data = periods, mapping=aes(xmin=300, xmax=0, ymin= -6, ymax= 0), linetype = 1, colour = "black", fill="black", alpha=1)  +
geom_rect(data = periods, mapping=aes(xmin = min_ma, xmax = max_ma, ymin = -6, ymax = -2), linetype = 1, colour = "black", fill=periods$color, alpha=1)  +
geom_text(data = periods, mapping=aes(x = mid_ma, y = -4, label = abbrev), colour = "black", alpha=1)  +
geom_point(data = data, mapping=aes(x = age, y = modern_temp_ext), colour = "darkgrey", size = 1.1, alpha  = 1) +
geom_point(data = stage_vals, mapping=aes(x = mid_ma, y = temperature), colour = "black", size = 1.1, alpha  = 1) +
geom_line(data = stage_vals, mapping=aes(x = mid_ma, y = temperature), colour = "black", size = 1.1, alpha  = 1) +
#geom_smooth(data = data, mapping=aes(x = age, y = modern_temp_ext), colour = "red", size = 1.1, alpha  = 0.75) +
scale_x_reverse(expand=c(0,0), limits = c(541, 0)) +
scale_y_continuous(expand=c(0,0), limits = c(-6, 65)) +
labs(x = "", y = expression(bold(paste("Temperature (",degree, C,")")))) +
theme(panel.background = element_blank(),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm"),
#panel.grid.minor.y = element_line(colour = "grey90"),
#panel.grid.minor.x = element_line(colour = "grey90"),
#panel.grid.major.y = element_line(colour = "grey90"),
#panel.grid.major.x = element_line(colour = "grey90"),
legend.position = c(0.2, 0.9),
legend.background = element_blank(),
legend.box.background = element_rect(colour = NA, fill = NA),
legend.key = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.margin=unit(0, "cm"),
panel.border = element_rect(colour = "black", fill = NA),
axis.text.x = element_text(size = 14, angle = 0, hjust = 0.5),
axis.text.y = element_text(size = 14, angle = 0, hjust = 0),
axis.title.y = element_text(size = 14, face = "bold", vjust = 4),
axis.title.y.right = element_text(size = 14, face = "bold", vjust = 4),
axis.title.x = element_text(size = 14, face = "bold", vjust = -1),
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
aspect.ratio = 0.4)
p1
#SST plot
#---------------------------------
library(ggplot2)
library(ggpubr)
#---------------------------------
#plot style
#get stages
stages <- read.csv("https://paleobiodb.org/data1.2/intervals/list.txt?scale_id=1&scale_level=5")
#get periods
periods <- read.csv("https://paleobiodb.org/data1.2/intervals/list.txt?scale_id=1&scale_level=3")
periods$mid_ma <- (periods$max_ma+periods$min_ma)/2
#shading data
s <- seq(2, nrow(periods), 2)
throwing_shade <- periods[s,]
#define colours for plots
col <- c("black")
#---------------------------------
#read data
data <- read.csv("./results/SST/extracted_temp.csv")
stage_vals <- read.csv("./results/SST/binned_vals.csv")
stage_vals$mid_ma <- (stage_vals$max_ma + stage_vals$min_ma)/2
p1 <- ggplot() +
#geom_segment(data = periods, mapping=aes(x = min_ma, xend = min_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
#geom_segment(data = periods, mapping=aes(x = max_ma, xend = max_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
geom_segment(data = periods, mapping=aes(x = 0, xend = 541, y = data$modern_temp_mean[1], yend = data$modern_temp_mean[1]), linetype = 1, size = 1, color = "royalblue1") +
geom_rect(data = throwing_shade, mapping=aes(xmin=min_ma, xmax=max_ma, ymin = -6, ymax= Inf), linetype = 0, color="grey90", alpha=0.1)  +
#geom_rect(data = periods, mapping=aes(xmin=300, xmax=0, ymin= -6, ymax= 0), linetype = 1, colour = "black", fill="black", alpha=1)  +
geom_rect(data = periods, mapping=aes(xmin = min_ma, xmax = max_ma, ymin = -6, ymax = -2), linetype = 1, colour = "black", fill=periods$color, alpha=1)  +
geom_text(data = periods, mapping=aes(x = mid_ma, y = -4, label = abbrev), colour = "black", alpha=1)  +
geom_point(data = data, mapping=aes(x = age, y = modern_temp_ext), colour = "darkgrey", size = 1.1, alpha  = 1) +
geom_point(data = stage_vals, mapping=aes(x = mid_ma, y = temperature), colour = "black", size = 1.1, alpha  = 1) +
geom_line(data = stage_vals, mapping=aes(x = mid_ma, y = temperature), colour = "black", size = 1.1, alpha  = 1) +
#geom_smooth(data = data, mapping=aes(x = age, y = modern_temp_ext), colour = "red", size = 1.1, alpha  = 0.75) +
scale_x_reverse(expand=c(0,0), limits = c(541, 0)) +
scale_y_continuous(expand=c(0,0), limits = c(-6, 65)) +
labs(x = "", y = expression(bold(paste("Temperature (",degree, C,")")))) +
theme(panel.background = element_blank(),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm"),
#panel.grid.minor.y = element_line(colour = "grey90"),
#panel.grid.minor.x = element_line(colour = "grey90"),
#panel.grid.major.y = element_line(colour = "grey90"),
#panel.grid.major.x = element_line(colour = "grey90"),
legend.position = c(0.2, 0.9),
legend.background = element_blank(),
legend.box.background = element_rect(colour = NA, fill = NA),
legend.key = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.margin=unit(0, "cm"),
panel.border = element_rect(colour = "black", fill = NA),
axis.text.x = element_text(size = 14, angle = 0, hjust = 0.5),
axis.text.y = element_text(size = 14, angle = 0, hjust = 0),
axis.title.y = element_text(size = 14, face = "bold", vjust = 4),
axis.title.y.right = element_text(size = 14, face = "bold", vjust = 4),
axis.title.x = element_text(size = 14, face = "bold", vjust = -1),
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
aspect.ratio = 0.4)
p1
p2 <- ggplot() +
#geom_segment(data = periods, mapping=aes(x = min_ma, xend = min_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
#geom_segment(data = periods, mapping=aes(x = max_ma, xend = max_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
geom_segment(data = periods, mapping=aes(x = 0, xend = 541, y = data$modern_temp_mean[1], yend = data$modern_temp_mean[1]), linetype = 1, size = 1, color = "royalblue1") +
geom_rect(data = throwing_shade, mapping=aes(xmin=min_ma, xmax=max_ma, ymin = -6, ymax= Inf), linetype = 0, color="grey90", alpha=0.1)  +
#geom_rect(data = periods, mapping=aes(xmin=300, xmax=0, ymin= -6, ymax= 0), linetype = 1, colour = "black", fill="black", alpha=1)  +
geom_rect(data = periods, mapping=aes(xmin = min_ma, xmax = max_ma, ymin = -6, ymax = -2), linetype = 1, colour = "black", fill=periods$color, alpha=1)  +
geom_text(data = periods, mapping=aes(x = mid_ma, y = -4, label = abbrev), colour = "black", alpha=1)  +
geom_point(data = data, mapping=aes(x = age, y = temperature), colour = "darkgrey", size = 1.1, alpha  = 1) +
geom_point(data = stage_vals, mapping=aes(x = mid_ma, y = temperature), colour = "black", size = 1.1, alpha  = 1) +
geom_line(data = stage_vals, mapping=aes(x = mid_ma, y = temperature), colour = "black", size = 1.1, alpha  = 1) +
#geom_smooth(data = data, mapping=aes(x = age, y = temperature), method = "loess", colour = "red", size = 1.1, alpha  = 0.75) +
scale_x_reverse(expand=c(0,0), limits = c(541, 0)) +
scale_y_continuous(expand=c(0,0), limits = c(-6, 65)) +
labs(x = "", y = expression(bold(paste("Temperature (",degree, C,")")))) +
theme(panel.background = element_blank(),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm"),
#panel.grid.minor.y = element_line(colour = "grey90"),
#panel.grid.minor.x = element_line(colour = "grey90"),
#panel.grid.major.y = element_line(colour = "grey90"),
#panel.grid.major.x = element_line(colour = "grey90"),
legend.position = c(0.2, 0.9),
legend.background = element_blank(),
legend.box.background = element_rect(colour = NA, fill = NA),
legend.key = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.margin=unit(0, "cm"),
panel.border = element_rect(colour = "black", fill = NA),
axis.text.x = element_text(size = 14, angle = 0, hjust = 0.5),
axis.text.y = element_text(size = 14, angle = 0, hjust = 0),
axis.title.y = element_text(size = 14, face = "bold", vjust = 4),
axis.title.y.right = element_text(size = 14, face = "bold", vjust = 4),
axis.title.x = element_text(size = 14, face = "bold", vjust = -1),
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
aspect.ratio = 0.4)
p2
plots <- ggarrange(p2, p1, ncol=1, nrow=2, widths = c(1,1), labels = "AUTO", align = "v")
plots
ggsave(file = "./figures/extracted_temperature.png", plot = plots, width = 150, height = 150, units = "mm", dpi = 600, scale = 1.7)
#read data
data <- read.csv("./results/SST/extracted_temp.csv")
#binned values
stages <- read.csv("https://paleobiodb.org/data1.2/intervals/list.txt?scale_id=1&scale_level=5")
#read data
data <- read.csv("./results/SST/extracted_temp.csv")
#calculate stage values
stages$temperature <- NA
stages$ext_temperature <- NA
#calcualte mean temperature
for(i in 1:nrow(stages)){
out <- subset(data, age < stages$max_ma[i] & age > stages$min_ma[i])
stages$temperature[i] <- mean(out$temperature, na.rm = TRUE)
stages$ext_temperature[i] <- mean(out$modern_temp_ext, na.rm = TRUE)
}
write.csv(stages, "./results/SST/binned_vals.csv", row.names = FALSE)
#SST plot
#---------------------------------
library(ggplot2)
library(ggpubr)
#---------------------------------
#plot style
#get stages
stages <- read.csv("https://paleobiodb.org/data1.2/intervals/list.txt?scale_id=1&scale_level=5")
#get periods
periods <- read.csv("https://paleobiodb.org/data1.2/intervals/list.txt?scale_id=1&scale_level=3")
periods$mid_ma <- (periods$max_ma+periods$min_ma)/2
#shading data
s <- seq(2, nrow(periods), 2)
throwing_shade <- periods[s,]
#define colours for plots
col <- c("black")
#---------------------------------
#read data
data <- read.csv("./results/SST/extracted_temp.csv")
stage_vals <- read.csv("./results/SST/binned_vals.csv")
stage_vals$mid_ma <- (stage_vals$max_ma + stage_vals$min_ma)/2
p1 <- ggplot() +
#geom_segment(data = periods, mapping=aes(x = min_ma, xend = min_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
#geom_segment(data = periods, mapping=aes(x = max_ma, xend = max_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
geom_segment(data = periods, mapping=aes(x = 0, xend = 541, y = data$modern_temp_mean[1], yend = data$modern_temp_mean[1]), linetype = 1, size = 1, color = "royalblue1") +
geom_rect(data = throwing_shade, mapping=aes(xmin=min_ma, xmax=max_ma, ymin = -6, ymax= Inf), linetype = 0, color="grey90", alpha=0.1)  +
#geom_rect(data = periods, mapping=aes(xmin=300, xmax=0, ymin= -6, ymax= 0), linetype = 1, colour = "black", fill="black", alpha=1)  +
geom_rect(data = periods, mapping=aes(xmin = min_ma, xmax = max_ma, ymin = -6, ymax = -2), linetype = 1, colour = "black", fill=periods$color, alpha=1)  +
geom_text(data = periods, mapping=aes(x = mid_ma, y = -4, label = abbrev), colour = "black", alpha=1)  +
geom_point(data = data, mapping=aes(x = age, y = modern_temp_ext), colour = "darkgrey", size = 1.1, alpha  = 1) +
geom_point(data = stage_vals, mapping=aes(x = mid_ma, y = ext_temperature), colour = "black", size = 1.1, alpha  = 1) +
geom_line(data = stage_vals, mapping=aes(x = mid_ma, y = ext_temperature), colour = "black", size = 1.1, alpha  = 1) +
#geom_smooth(data = data, mapping=aes(x = age, y = modern_temp_ext), colour = "red", size = 1.1, alpha  = 0.75) +
scale_x_reverse(expand=c(0,0), limits = c(541, 0)) +
scale_y_continuous(expand=c(0,0), limits = c(-6, 65)) +
labs(x = "", y = expression(bold(paste("Temperature (",degree, C,")")))) +
theme(panel.background = element_blank(),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm"),
#panel.grid.minor.y = element_line(colour = "grey90"),
#panel.grid.minor.x = element_line(colour = "grey90"),
#panel.grid.major.y = element_line(colour = "grey90"),
#panel.grid.major.x = element_line(colour = "grey90"),
legend.position = c(0.2, 0.9),
legend.background = element_blank(),
legend.box.background = element_rect(colour = NA, fill = NA),
legend.key = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.margin=unit(0, "cm"),
panel.border = element_rect(colour = "black", fill = NA),
axis.text.x = element_text(size = 14, angle = 0, hjust = 0.5),
axis.text.y = element_text(size = 14, angle = 0, hjust = 0),
axis.title.y = element_text(size = 14, face = "bold", vjust = 4),
axis.title.y.right = element_text(size = 14, face = "bold", vjust = 4),
axis.title.x = element_text(size = 14, face = "bold", vjust = -1),
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
aspect.ratio = 0.4)
p1
#SST plot
#---------------------------------
library(ggplot2)
library(ggpubr)
#---------------------------------
#plot style
#get stages
stages <- read.csv("https://paleobiodb.org/data1.2/intervals/list.txt?scale_id=1&scale_level=5")
#get periods
periods <- read.csv("https://paleobiodb.org/data1.2/intervals/list.txt?scale_id=1&scale_level=3")
periods$mid_ma <- (periods$max_ma+periods$min_ma)/2
#shading data
s <- seq(2, nrow(periods), 2)
throwing_shade <- periods[s,]
#define colours for plots
col <- c("black")
#---------------------------------
#read data
data <- read.csv("./results/SST/extracted_temp.csv")
stage_vals <- read.csv("./results/SST/binned_vals.csv")
stage_vals$mid_ma <- (stage_vals$max_ma + stage_vals$min_ma)/2
p1 <- ggplot() +
#geom_segment(data = periods, mapping=aes(x = min_ma, xend = min_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
#geom_segment(data = periods, mapping=aes(x = max_ma, xend = max_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
geom_segment(data = periods, mapping=aes(x = 0, xend = 541, y = data$modern_temp_mean[1], yend = data$modern_temp_mean[1]), linetype = 1, size = 1, color = "royalblue1") +
geom_rect(data = throwing_shade, mapping=aes(xmin=min_ma, xmax=max_ma, ymin = -6, ymax= Inf), linetype = 0, color="grey90", alpha=0.1)  +
#geom_rect(data = periods, mapping=aes(xmin=300, xmax=0, ymin= -6, ymax= 0), linetype = 1, colour = "black", fill="black", alpha=1)  +
geom_rect(data = periods, mapping=aes(xmin = min_ma, xmax = max_ma, ymin = -6, ymax = -2), linetype = 1, colour = "black", fill=periods$color, alpha=1)  +
geom_text(data = periods, mapping=aes(x = mid_ma, y = -4, label = abbrev), colour = "black", alpha=1)  +
geom_point(data = data, mapping=aes(x = age, y = modern_temp_ext), colour = "darkgrey", size = 1.1, alpha  = 1) +
geom_point(data = stage_vals, mapping=aes(x = mid_ma, y = ext_temperature), colour = "black", size = 1.1, alpha  = 1) +
geom_line(data = stage_vals, mapping=aes(x = mid_ma, y = ext_temperature), colour = "black", size = 1.1, alpha  = 1) +
#geom_smooth(data = data, mapping=aes(x = age, y = modern_temp_ext), colour = "red", size = 1.1, alpha  = 0.75) +
scale_x_reverse(expand=c(0,0), limits = c(541, 0)) +
scale_y_continuous(expand=c(0,0), limits = c(-6, 65)) +
labs(x = "", y = expression(bold(paste("Temperature (",degree, C,")")))) +
theme(panel.background = element_blank(),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm"),
#panel.grid.minor.y = element_line(colour = "grey90"),
#panel.grid.minor.x = element_line(colour = "grey90"),
#panel.grid.major.y = element_line(colour = "grey90"),
#panel.grid.major.x = element_line(colour = "grey90"),
legend.position = c(0.2, 0.9),
legend.background = element_blank(),
legend.box.background = element_rect(colour = NA, fill = NA),
legend.key = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.margin=unit(0, "cm"),
panel.border = element_rect(colour = "black", fill = NA),
axis.text.x = element_text(size = 14, angle = 0, hjust = 0.5),
axis.text.y = element_text(size = 14, angle = 0, hjust = 0),
axis.title.y = element_text(size = 14, face = "bold", vjust = 4),
axis.title.y.right = element_text(size = 14, face = "bold", vjust = 4),
axis.title.x = element_text(size = 14, face = "bold", vjust = -1),
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
aspect.ratio = 0.4)
p1
p2 <- ggplot() +
#geom_segment(data = periods, mapping=aes(x = min_ma, xend = min_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
#geom_segment(data = periods, mapping=aes(x = max_ma, xend = max_ma, y = -6, yend = Inf), linetype = 2, size = 1, color = "grey90") +
geom_segment(data = periods, mapping=aes(x = 0, xend = 541, y = data$modern_temp_mean[1], yend = data$modern_temp_mean[1]), linetype = 1, size = 1, color = "royalblue1") +
geom_rect(data = throwing_shade, mapping=aes(xmin=min_ma, xmax=max_ma, ymin = -6, ymax= Inf), linetype = 0, color="grey90", alpha=0.1)  +
#geom_rect(data = periods, mapping=aes(xmin=300, xmax=0, ymin= -6, ymax= 0), linetype = 1, colour = "black", fill="black", alpha=1)  +
geom_rect(data = periods, mapping=aes(xmin = min_ma, xmax = max_ma, ymin = -6, ymax = -2), linetype = 1, colour = "black", fill=periods$color, alpha=1)  +
geom_text(data = periods, mapping=aes(x = mid_ma, y = -4, label = abbrev), colour = "black", alpha=1)  +
geom_point(data = data, mapping=aes(x = age, y = temperature), colour = "darkgrey", size = 1.1, alpha  = 1) +
geom_point(data = stage_vals, mapping=aes(x = mid_ma, y = temperature), colour = "black", size = 1.1, alpha  = 1) +
geom_line(data = stage_vals, mapping=aes(x = mid_ma, y = temperature), colour = "black", size = 1.1, alpha  = 1) +
#geom_smooth(data = data, mapping=aes(x = age, y = temperature), method = "loess", colour = "red", size = 1.1, alpha  = 0.75) +
scale_x_reverse(expand=c(0,0), limits = c(541, 0)) +
scale_y_continuous(expand=c(0,0), limits = c(-6, 65)) +
labs(x = "", y = expression(bold(paste("Temperature (",degree, C,")")))) +
theme(panel.background = element_blank(),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm"),
#panel.grid.minor.y = element_line(colour = "grey90"),
#panel.grid.minor.x = element_line(colour = "grey90"),
#panel.grid.major.y = element_line(colour = "grey90"),
#panel.grid.major.x = element_line(colour = "grey90"),
legend.position = c(0.2, 0.9),
legend.background = element_blank(),
legend.box.background = element_rect(colour = NA, fill = NA),
legend.key = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.margin=unit(0, "cm"),
panel.border = element_rect(colour = "black", fill = NA),
axis.text.x = element_text(size = 14, angle = 0, hjust = 0.5),
axis.text.y = element_text(size = 14, angle = 0, hjust = 0),
axis.title.y = element_text(size = 14, face = "bold", vjust = 4),
axis.title.y.right = element_text(size = 14, face = "bold", vjust = 4),
axis.title.x = element_text(size = 14, face = "bold", vjust = -1),
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
aspect.ratio = 0.4)
p2
plots <- ggarrange(p2, p1, ncol=1, nrow=2, widths = c(1,1), labels = "AUTO", align = "v")
plots
ggsave(file = "./figures/extracted_temperature.png", plot = plots, width = 150, height = 150, units = "mm", dpi = 600, scale = 1.7)
library(raster)
library(raster)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
library(raster)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
modern <- rowMeans(as.matrix(modern))
albian <- rowMeans(as.matrix(albian))
library(raster)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
modern <- rowMeans(as.matrix(modern), na.rm = TRUE)
albian <- rowMeans(as.matrix(albian), na.rm = TRUE)
plot(albian)
points(modern)
modern
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
modern[,1]
lats <- xyFromCell(modern[,1])
lats <- xyFromCell(modern)
nrow(modern)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
lats <- rasterToPoints(modern)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
lats <- rasterToPoints(modern[,1])
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
lats <- rasterToPoints(modern)
lats
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
lats <- data.frame(rasterToPoints(modern))
lats <- unique(lats$y)
library(raster)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
lats <- data.frame(rasterToPoints(modern))
lats <- unique(lats$y)
modern <- rowMeans(as.matrix(modern), na.rm = TRUE)
albian <- rowMeans(as.matrix(albian), na.rm = TRUE)
data <- as.data.frame(modern, albian, lats)
plot(x = lats, y = albian, data = data)
plot(x = lats, y = modern, data = data, add = TRUE)
library(raster)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
lats <- data.frame(rasterToPoints(albian))
lats <- unique(lats$y)
modern <- rowMeans(as.matrix(modern), na.rm = TRUE)
albian <- rowMeans(as.matrix(albian), na.rm = TRUE)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
albian
lats <- data.frame(rasterToPoints(albian))
unique(lats$y)
lats <- seq(-90, 90, length.out = length(albian))
library(raster)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
lats <- data.frame(rasterToPoints(albian))
lats <- unique(lats$y)
modern <- rowMeans(as.matrix(modern), na.rm = TRUE)
albian <- rowMeans(as.matrix(albian), na.rm = TRUE)
lats <- seq(-90, 90, length.out = length(albian))
data <- as.data.frame(modern, albian, lats)
library(raster)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
lats <- data.frame(rasterToPoints(albian))
lats <- unique(lats$y)
modern <- rowMeans(as.matrix(modern), na.rm = TRUE)
albian <- rowMeans(as.matrix(albian), na.rm = TRUE)
lats <- seq(-90, 90, length.out = length(albian))
data <- as.data.frame(modern, albian, lats)
data <- cbind.data.frame(modern, albian, lats)
plot(x = lats, y = albian, data = data)
library(raster)
modern <- raster("./data/layers/pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
lats <- data.frame(rasterToPoints(albian))
lats <- unique(lats$y)
modern <- rowMeans(as.matrix(modern), na.rm = TRUE)
albian <- rowMeans(as.matrix(albian), na.rm = TRUE)
lats <- seq(-90, 90, length.out = length(albian))
data <- cbind.data.frame(modern, albian, lats)
plot(x = lats, y = albian, data = data, xlab = "Latitude", ylab = "Temperature")
plot(x = lats, y = modern, data = data, add = TRUE)
plot(x = lats, y = albian, data = data, xlab = "Latitude", ylab = "Temperature")
points(x = lats, y = modern, data = data)
plot(x = lats, y = albian, data = data, xlab = "Latitude", ylab = "Temperature", pch = 20, col = "red")
points(x = lats, y = modern, data = data, pch = 20, col = "blue")
modern <- raster("./data/layers/Pre_industrial.nc")
albian <- raster("./data/layers/Ypresian.nc")
lats <- data.frame(rasterToPoints(albian))
lats <- unique(lats$y)
modern <- rowMeans(as.matrix(modern), na.rm = TRUE)
albian <- rowMeans(as.matrix(albian), na.rm = TRUE)
lats <- seq(-90, 90, length.out = length(albian))
data <- cbind.data.frame(modern, albian, lats)
plot(x = lats, y = albian, data = data, xlab = "Latitude", ylab = "Temperature", pch = 20, col = "red")
points(x = lats, y = modern, data = data, pch = 20, col = "blue")
r <- raster(res = 1)
library(raster)
r <- raster(res = 1)
modern <- raster("./data/layers/Pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
modern <- resample(modern, r)
albian <- resample(albian, r)
lats <- data.frame(rasterToPoints(albian))
lats <- unique(lats$y)
modern <- rowMeans(as.matrix(modern), na.rm = TRUE)
albian <- rowMeans(as.matrix(albian), na.rm = TRUE)
lats <- seq(-90, 90, length.out = length(albian))
data <- cbind.data.frame(modern, albian, lats)
plot(x = lats, y = albian, data = data, xlab = "Latitude", ylab = "Temperature", pch = 20, col = "red")
points(x = lats, y = modern, data = data, pch = 20, col = "blue")
library(raster)
r <- raster(res = 1)
modern <- raster("./data/layers/Pre_industrial.nc")
albian <- raster("./data/layers/Albian.nc")
modern <- resample(modern, r)
albian <- resample(albian, r)
lats <- data.frame(rasterToPoints(albian))
lats <- unique(lats$y)
modern <- rowMeans(as.matrix(modern), na.rm = TRUE)
albian <- rowMeans(as.matrix(albian), na.rm = TRUE)
lats <- seq(-90, 90, length.out = length(albian))
data <- cbind.data.frame(modern, albian, lats)
plot(x = lats, y = albian, data = data, xlab = "Latitude", ylab = "Temperature", pch = 20, col = "red")
points(x = lats, y = modern, data = data, pch = 20, col = "blue")
legend(1, 95, legend=c("Albian", "Modern"),
col=c("red", "blue"), lty=1:2, cex=0.8)
plot(x = lats, y = albian, data = data, xlab = "Latitude", ylab = "Temperature", pch = 20, col = "red")
points(x = lats, y = modern, data = data, pch = 20, col = "blue")
legend(1, 95, legend=c("Albian", "Modern"),
col=c("red", "blue"), lty=1:2, cex=0.8)
legend(1, 95, legend=c("Albian", "Modern"),
col=c("red", "blue"), lty=1:2, cex=3)
legend("topleft", legend=c("Albian", "Modern"),
col=c("red", "blue"), lty=1:2, cex=3)
plot(x = lats, y = albian, data = data, xlab = "Latitude", ylab = "Temperature", pch = 20, col = "red")
points(x = lats, y = modern, data = data, pch = 20, col = "blue")
legend("topleft", legend=c("Albian", "Modern"),
col=c("red", "blue"), lty=1:2, cex=0.8)
plot(x = lats, y = albian, data = data, xlab = "Latitude", ylab = "Temperature", pch = 20, col = "red")
points(x = lats, y = modern, data = data, pch = 20, col = "blue")
legend("topleft", legend=c("Albian", "Modern"),
col=c("red", "blue"), pch = 20, cex=0.8)
